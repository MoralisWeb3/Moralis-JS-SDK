<div align="center">
    <p align="center">
      <img src="./.readme/MoralisLogo.png" alt="Moralis NextJS" />
    </p>
</div>

<div align="center">

![npm](https://img.shields.io/npm/v/@moralisweb3/next)
![node-current](https://img.shields.io/node/v/@moralisweb3/next)
![GitHub last commit](https://img.shields.io/github/last-commit/MoralisWeb3/@moralisweb3/next)
![npm bundle size](https://img.shields.io/bundlephobia/minzip/@moralisweb3/next)
![npm type definitions](https://img.shields.io/npm/types/@moralisweb3/next)

</div>

# `@moralisweb3/next`

> Moralis Hooks for your NextJS project

This project is a thin NextJS wrapper around [Moralis](https://moralis.io/), to easily call functionalities and display data. It  serves as a proxy, to allow users to access Moralis APIs in client-side.

Please check the [official documentation of Moralis](https://docs.moralis.io/) for all the functionalities of Moralis.

# üöÄ Quick start

### 1. Install Dependencies

Make sure to have `next`, `react`, `react-dom` and `moralis` installed as dependencies, then install `@moralisweb3/next`

In short:

```sh
npm install moralis @moralisweb3/next next react react-dom
```

or

```sh
yarn add moralis @moralisweb3/next next react react-dom
```

> Make sure to also  `moralis` to the latest version, when you update `@moralisweb3/next`.

### 2. Create environment variables file

Add a new file `.env.local` in project's root and provide a new variable with [Moralis API key](https://docs.moralis.io/docs/nextjs-dapp#add-moralis-to-your-nextjs-dapp):

```sh
MORALIS_API_KEY= ***
```

### 3. Create API route
To use Moralis APIs in your NextJs project create a file `pages/api/moralis/[...moralis].ts` with following code:

```js
import { MoralisNextApi } from "@moralisweb3/next";

export default MoralisNextApi({ apiKey: process.env.MORALIS_API_KEY });
```

You can provide a configuration object to the `MoralisNextApi`.

# ‚≠êÔ∏è Star us

If this "@moralisweb3/next" library helps you build your dapps faster - please star this project, every star makes us very happy!

# ü§ù Need help

If you need help with setting up the boilerplate or have other questions - don't hesitate to write in our community forum and we will check asap. [Forum link](https://forum.moralis.io). The best thing about this SDK is the super active community ready to help at any time! We help each other.

# üß≠ Table of Contents

- [üöÄ Quick start](#-quick-start)
  - [1. Install Dependencies](#1-install-dependencies)
  - [2. Create environment variables file](#2-create-environment-variables-file)
  - [3. Create API route](#2-create-api-route)
- [‚≠êÔ∏è Star us](#Ô∏è-star-us)
- [ü§ù Need help](#-need-help)
- [üß≠ Table of Contents](#-table-of-contents)
- [üîê Authentication and Session Management with NextAuth](#Ô∏è-authentication-and-session-management-with-nextauth)
- [‚ú® Hook Usage Example](#Ô∏è-hook-usage-example)
- [‚öôÔ∏è Hook Advanced Config](#Ô∏è-hook-advanced-config)
- [Authentication Api Hooks](#-authentication-api-hooks)
  - [useAuthRequestChallengeSolana](#Ô∏è-useAuthRequestChallengeSolana)
  - [useAuthRequestChallengeEvm](#-useAuthRequestChallengeEvm)
- [Evm Api Hooks](#-evm-api-hooks)
- [Solana Api Hooks](#-solana-api-hooks)
- [üßô‚Äç‚ôÇÔ∏è Community](#Ô∏è-community)

# üîê Authentication and Session Management with NextAuth

The `@moralisweb3/next` library provides first class tools for web3 authentication. Using the [NextAuth.js](https://next-auth.js.org/) and our custom `MoralisNextAuthProvider()` you can implement web3 authentication you can create web3 authentication for any web3 wallet.

Please follow [Sign In with MetaMask](https://docs.moralis.io/docs/sign-in-with-metamask) Tutorial for NextJS.

# ‚ú® Hook Usage Example

```jsx
import { useEvmWalletTokenBalances } from '@moralisweb3/next'

const App = () => {
  const { data: balance, error, refetch, isValidating } = useEvmWalletTokenBalances({ address: '0x...' })

  if (isValidating) return <div>Fetching/Refreshing balance‚Ä¶</div>
  if (error) return <div>{JSON.stringify(error, null, 2)}</div>
  return (
    <>
      <button onClick={refetch}>Refetch Balance</button>
      <div>{JSON.stringify(balance, null, 2)}</div>
    </>
  )
}
```

# ‚öôÔ∏è Hook Advanced Config

The `@moralisweb3/next` hooks use [SWR](https://swr.vercel.app/) for a better developer experience. You can provide [config object](https://swr.vercel.app/docs/options#options) to the hooks as it's shown bellow:

```jsx
const { data } = useEvmWalletTokenBalances({ address: '0x...' }, { revalidateOnFocus: true })
```

# Authentication Api Hooks

## `useAuthRequestChallengeSolana()` 

The back channel challenge containing the id to store on the api and the message to be signed by the user

### Params:
```ts
{
  address: SolAddressish;
  network: SolNetworkish;
  expirationTime?: DateInput;
  notBefore?: DateInput;
}; 
```

### Response:
```ts
{ id: string; message: string; profileId: string }; 
```

## `useAuthRequestChallengeEvm()` 

The back channel challenge containing the id to store on the api and the message to be signed by the user

### Params:
```ts
{
  address: EvmAddressish;
  chainId: EvmChainish;
  expirationTime?: DateInput;
  notBefore?: DateInput;
}; 
```

### Response:
```ts
{ id: string; message: string; profileId: string }; 
```

# Evm Api Hooks

# Solana Api Hooks

# üßô‚Äç‚ôÇÔ∏è Community

- [Discord](https://discord.gg/moralis)
- [Forum](https://forum.moralis.io)